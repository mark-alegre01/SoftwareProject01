{% extends 'core/base.html' %}
{% load static %}

{% block title %}Log in - RecourseCheck{% endblock %}

{% block extra_css %}
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
<style>
  body {
    background: radial-gradient(circle at top, #e0f2fe 0, #f3f4f6 45%, #eef2ff 100%) !important;
  }
  .material-symbols-outlined {
    font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
  }
  .login-container {
    position: fixed;
    inset: 0;
    background:
      radial-gradient(circle at 0% 0%, rgba(79, 70, 229, 0.12), transparent 55%),
      radial-gradient(circle at 100% 100%, rgba(56, 189, 248, 0.1), transparent 55%),
      #f3f4f6;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
  }
  main {
    display: none !important;
  }

  .login-card {
    animation: loginFloatIn 0.6s cubic-bezier(0.22, 1, 0.36, 1);
    box-shadow: 0 25px 60px rgba(15, 23, 42, 0.18);
    position: relative;
    overflow: hidden;
  }

  .login-card::before {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at top left, rgba(59,130,246,0.16), transparent 50%);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.4s ease;
  }

  .login-card:hover::before {
    opacity: 1;
  }

  .login-orbit {
    width: 72px;
    height: 72px;
    border-radius: 999px;
    border: 1px dashed rgba(148, 163, 184, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: visible;
  }

  .login-orbit::after {
    content: "";
    position: absolute;
    width: 10px;
    height: 10px;
    border-radius: 999px;
    background: linear-gradient(135deg, #6366f1, #22d3ee);
    box-shadow: 0 0 12px rgba(59,130,246,0.7);
    animation: orbitDot 7s linear infinite;
  }

  .login-input-wrap {
    transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease;
  }

  .login-input-wrap:focus-within {
    transform: translateY(-2px);
    border-color: #22c55e;
    box-shadow: 0 12px 30px rgba(34,197,94,0.18);
  }

  .login-cta {
    position: relative;
    overflow: hidden;
  }

  .login-cta::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(120deg, rgba(248, 250, 252, 0.25), transparent 60%);
    transform: translateX(-100%);
    transition: transform 0.6s ease;
  }

  .login-cta:hover::after {
    transform: translateX(100%);
  }

  @keyframes loginFloatIn {
    from {
      opacity: 0;
      transform: translateY(16px) scale(0.96);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  @keyframes orbitDot {
    0% {
      transform: rotate(0deg) translateX(36px);
    }
    100% {
      transform: rotate(360deg) translateX(36px);
    }
  }
</style>
{% endblock %}

{% block guest_content %}
<div class="login-container">
  <div class="flex items-center justify-center gap-20">
    <!-- Left Logo / School -->
    <div class="hidden lg:flex flex-col items-center gap-3">
      <div class="login-orbit">
        <div class="w-14 h-14 rounded-full overflow-hidden bg-white shadow ring-2 ring-white/70">
          <img src="{% static 'img/sdnsu-logo.png' %}"
               alt="Surigao del Norte State University Logo"
               class="w-full h-full object-cover" />
        </div>
      </div>
      <p class="text-xs font-medium text-gray-500 uppercase tracking-[0.25em]">School Portal</p>
    </div>

    <!-- Center Card -->
    <div class="w-full max-w-sm bg-white/95 backdrop-blur rounded-2xl border border-gray-200/80 p-8 login-card">
      <div class="text-center mb-8">
        <h1 class="text-3xl font-black text-gray-900">Welcome back</h1>
        <p class="mt-2 text-gray-600 text-sm">Sign in to access the RecourseCheck RFID borrowing portal.</p>
      </div>

      <form method="post" novalidate class="space-y-5">
        {% csrf_token %}
        {% if next_value %}<input type="hidden" name="next" value="{{ next_value }}">{% endif %}

        {% if form.non_field_errors %}
          <div class="bg-red-50 border border-red-200 rounded p-3">
            {% for error in form.non_field_errors %}<p class="text-sm text-red-700">{{ error }}</p>{% endfor %}
          </div>
        {% endif %}

        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">{{ form.username.label }}</label>
          <div class="flex border border-gray-300 rounded-lg overflow-hidden login-input-wrap bg-gray-50/60">
            <input type="text" name="username" id="id_username" placeholder="Enter your email or username" 
                   value="{{ form.username.value|default:'' }}" required
                   class="flex-1 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none text-sm"/>
            <div class="flex items-center px-4 text-gray-500">
              <span class="material-symbols-outlined" style="font-size: 20px;">person</span>
            </div>
          </div>
          {% if form.username.errors %}<p class="text-red-600 text-xs mt-1">{{ form.username.errors|join:', ' }}</p>{% endif %}
        </div>

        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">{{ form.password.label }}</label>
          <div class="flex border border-gray-300 rounded-lg overflow-hidden login-input-wrap bg-gray-50/60">
            <input type="password" name="password" id="id_password" placeholder="Enter your password" required
                   class="flex-1 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none text-sm"/>
            <div class="flex items-center px-4 text-gray-500">
              <span class="material-symbols-outlined" style="font-size: 20px;">visibility_off</span>
            </div>
          </div>
          {% if form.password.errors %}<p class="text-red-600 text-xs mt-1">{{ form.password.errors|join:', ' }}</p>{% endif %}
        </div>

        <div class="text-center">
          <a href="#" class="text-green-500 hover:text-green-600 text-sm font-medium underline-offset-4 hover:underline">Forgot Password?</a>
        </div>

        <button type="submit" class="w-full bg-gradient-to-r from-emerald-500 to-lime-500 hover:from-emerald-600 hover:to-lime-600 text-white font-bold py-3 rounded-lg transition text-base login-cta shadow-lg">
          Log In
        </button>
      </form>

      <div class="text-center mt-6">
        <p class="text-sm text-gray-600">Don't have an account? 
          <a href="{% url 'core:register' %}" class="font-semibold text-green-500 hover:text-green-600">Sign Up</a>
        </p>
      </div>
    </div>

    <!-- Right RecourseCheck Logo -->
    <div class="hidden lg:flex flex-col items-center gap-3">
      <div class="login-orbit">
        <div class="w-14 h-14 rounded-2xl bg-gradient-to-tr from-sky-500 via-indigo-500 to-emerald-400 flex items-center justify-center shadow-lg">
          <span class="material-symbols-outlined text-white" style="font-size: 30px;">auto_stories</span>
        </div>
      </div>
      <div class="text-center space-y-0.5">
        <p class="text-xs font-medium text-gray-500 uppercase tracking-[0.24em]">RecourseCheck</p>
        <p class="text-sm font-semibold text-gray-900">Smart RFID Borrowing</p>
      </div>
    </div>
  </div>
</div>
{% endblock %}


